"0","bestsize = 0"
"0","bestscore = 0.8601935"
"0","plotter <- matrix(nrow = 100, ncol = 2, byrow = TRUE)"
"0","for(k in 0:100){"
"0","  size = k"
"0","  #tempdf <- MAPred"
"0","  tempdf <- tempdf2"
"0","  "
"0","  for (i in 5:length(tempdf)){"
"0","    if (tempdf[i] == TRUE && tempdf[i-1] == TRUE && tempdf[i-2] == TRUE && tempdf[i-3] == TRUE){"
"0","      for(j in 1:size){"
"0","        tempdf[i-3-j] = TRUE"
"0","      }"
"0","    }"
"0","  }"
"0","  "
"0","  NDM <- table(tempdf, spedpred$ATT_FLAG)"
"0","  score = F1calc(NDM[4],NDM[2],NDM[3])"
"0","  plotter[k,1] = size"
"0","  plotter[k,2] = score"
"0","  if (score > bestscore){"
"0","    bestsize = size"
"0","    bestscore = score"
"0","  }"
"0","}"
"0","plot(x = plotter[,1], y = plotter[,2],pch = 16, col=ifelse(plotter[,1]==bestsize, ""red"", ""black""))"
